Version 4
SHEET 1 2644 1092
WIRE 1136 464 1104 464
WIRE 1248 464 1200 464
WIRE 1408 464 1328 464
WIRE 896 512 752 512
WIRE 1408 544 1408 464
WIRE 1408 544 1296 544
WIRE 1440 544 1408 544
WIRE 1648 544 1520 544
WIRE 1696 544 1648 544
WIRE 896 560 896 512
WIRE 1104 560 1104 464
WIRE 1232 560 1104 560
WIRE 752 576 752 512
WIRE 1408 576 1296 576
WIRE 1696 576 1696 544
WIRE 1408 624 1408 576
WIRE 1520 624 1408 624
WIRE 1536 624 1520 624
WIRE 1104 640 1104 560
WIRE 896 672 896 640
WIRE 1536 720 1536 624
WIRE 1696 720 1696 656
WIRE 400 768 368 768
WIRE 464 768 400 768
WIRE 656 768 528 768
WIRE 752 768 752 656
WIRE 752 768 656 768
WIRE 832 768 752 768
WIRE 1104 768 1104 720
WIRE 1104 768 1024 768
WIRE 656 816 656 768
WIRE 832 864 784 864
WIRE 1072 864 1024 864
WIRE 1536 864 1536 800
WIRE 656 928 656 880
WIRE 784 928 784 864
WIRE 784 928 656 928
WIRE 784 976 784 928
WIRE 1072 976 1072 864
FLAG 1072 976 0
FLAG 784 976 0
FLAG 896 672 0
FLAG 1696 720 0
FLAG 1104 464 ve
FLAG 1536 864 0
FLAG 1520 624 vs
FLAG 400 768 vc
FLAG 1648 544 vref
DATAFLAG 672 768 ""
DATAFLAG 1104 768 ""
DATAFLAG 1136 560 ""
SYMBOL MyOpto 928 816 M0
WINDOW 123 0 108 Center 2
WINDOW 39 0 136 Center 2
WINDOW 40 0 164 Center 2
SYMATTR SpiceLine2 Cop=0.1n
SYMATTR InstName U4
SYMBOL res 736 560 R0
SYMATTR InstName Rc
SYMATTR Value 6.1k
SYMBOL voltage 896 544 R0
WINDOW 0 45 23 Left 2
WINDOW 3 40 59 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL cap 640 816 R0
SYMATTR InstName Cop
SYMATTR Value 10n
SYMBOL res 1088 624 R0
SYMATTR InstName Rop
SYMATTR Value 2.22k
SYMBOL MyOpamp 1264 560 R180
WINDOW 39 -43 -74 Center 2
WINDOW 40 -57 -99 Center 2
WINDOW 38 16 -22 Left 2
SYMATTR InstName U5
SYMBOL res 1344 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 13.1k
SYMBOL res 1536 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 5k
SYMBOL cap 1200 448 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL voltage 1536 704 R0
WINDOW 123 38 71 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 40 41 Left 2
WINDOW 0 39 10 Left 2
SYMATTR Value2 AC 1
SYMATTR Value 0.4501
SYMATTR InstName V3
SYMBOL voltage 1696 560 R0
WINDOW 0 54 36 Left 2
WINDOW 3 45 64 Left 2
SYMATTR InstName V2
SYMATTR Value 0.45
SYMBOL Control\\gain 496 768 M0
WINDOW 0 23 -15 Bottom 2
WINDOW 3 9 62 Bottom 2
SYMATTR InstName U1
SYMATTR Value A=-1
TEXT 624 424 Left 2 !.ac dec 101 1 100k
TEXT 600 1032 Left 2 ;We must be sure that both the LED and the bipolar transistor\noperate in linear mode
TEXT 1568 824 Left 2 ;Trick: \nput a small difference between sensed \nand reference voltages to make the OPAMP\noperate with a suitable DC output voltage
TEXT 944 416 Left 2 !;.op
